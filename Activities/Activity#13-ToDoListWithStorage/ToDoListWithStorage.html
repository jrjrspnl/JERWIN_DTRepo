<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dynamic To Do List Storage</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>
  <body>
    <div class="flex flex-col items-center justify-center h-screen mx-5">
      <h1 class="mb-5 text-3xl font-bold">To-do List with Storage</h1>
      <div
        class="w-full p-4 rounded-md shadow-lg sm:w-w-1/2 md:w-1/3 dark:bg-neutral-800 shadow-gray-700"
      >
        <h5 class="mb-2 text-sm tracking-tight text-white">Today's Task:</h5>

        <p id="emptyList" class="text-gray-400">No tasks added yet.</p>
        <ul id="taskList" class="mt-3 list-disc pl-5 text-white"></ul>
        <div class="flex gap-x-2 mt-5">
          <input
            class="w-full px-2 py-2 border rounded-sm border-neutral-300 bg-white"
            type="text"
            placeholder="Enter your task"
            id="inputTask"
          />
        </div>
      </div>
    </div>
    <!--nireuse ko lang po ung dating to do list and nilagyan ko po to ng local storage feature-->
    <script>
      const inputTask = document.getElementById("inputTask");
      const taskList = document.getElementById("taskList");
      const emptyList = document.getElementById("emptyList");

      window.onload = function () {
        const savedTasks = JSON.parse(localStorage.getItem("tasks")) || [];
        savedTasks.forEach((task) => addTask(task.text, task.completed));
      };

      function saveToLocalStorage() {
        const tasks = [];
        document.querySelectorAll("#taskList li").forEach((li) => {
          const text = li.querySelector("span").textContent;
          const completed =
            li.querySelector("span").style.textDecoration === "line-through";
          tasks.push({ text, completed });
        });
        localStorage.setItem("tasks", JSON.stringify(tasks));
      }

      function addTask(text, completed = false) {
        emptyList.style.display = "none";

        const li = document.createElement("li");
        li.className = "mb-2";

        const taskContainer = document.createElement("div");
        taskContainer.className = "flex justify-between items-center";

        const taskText = document.createElement("span");
        taskText.textContent = text;
        taskText.style.textDecoration = completed ? "line-through" : "none";

        const btnContainer = document.createElement("div");
        btnContainer.className = "flex gap-x-2";

        //complete task
        const completeBtn = document.createElement("button");
        completeBtn.innerHTML = "&#x2714;";
        completeBtn.className =
          "px-4 py-2 bg-green-400 rounded-md cursor-pointer transition hover:scale-105 duration-200";
        completeBtn.onclick = function () {
          taskText.style.textDecoration =
            taskText.style.textDecoration === "line-through"
              ? "none"
              : "line-through";

          saveToLocalStorage();
        };

        //remove task
        const removeBtn = document.createElement("button");
        removeBtn.innerHTML = "&#x2716;";
        removeBtn.className =
          "px-4 py-2 bg-red-400 rounded-md cursor-pointer transition hover:scale-105 duration-200";
        removeBtn.onclick = function () {
          li.remove();
          if (taskList.children.length === 0) {
            emptyList.style.display = "block";
          }
          saveToLocalStorage();
        };

        btnContainer.appendChild(completeBtn);
        btnContainer.appendChild(removeBtn);
        taskContainer.appendChild(taskText);
        taskContainer.appendChild(btnContainer);
        li.append(taskContainer);
        taskList.appendChild(li);
      }

      inputTask.addEventListener("keydown", function (event) {
        if (event.key === "Enter" && inputTask.value.trim() !== "") {
          addTask(inputTask.value);

          saveToLocalStorage();

          inputTask.value = "";
        }
      });
    </script>
  </body>
</html>
